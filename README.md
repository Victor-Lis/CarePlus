<h1>Care+ üíñ</h1>

## Resumo üìã
O projeto "Care+ (CarePlus)" surgiu a partir de um desafio t√©cnico que me propus a desevolver, onde havia a op√ß√£o de construir um entre os dois seguintes projetos:
- 1 - üé® Landing Page - Empresa de Absorventes ‚úîÔ∏è
- 2 - üîß API REST - Sistema de Chamados ‚úñÔ∏è

Embora j√° tenha desenvolvido os mais variados projetos nas mais distintas stacks, tenho uma prefer√™ncia pela constru√ß√£o de aplica√ß√µes web, portanto, escolhi a op√ß√£o 1. 

https://github.com/user-attachments/assets/a259911a-c162-4fd5-8009-3485f16fa84f

<br>

## Techs üõ†
<div align="center" style="display: flex">
  <img align="center" alt="TypeScript" width="35" height="35" src="https://github.com/devicons/devicon/blob/master/icons/typescript/typescript-original.svg">
  <img align="center" alt="React" width="65" height="35" src="https://github.com/devicons/devicon/blob/master/icons/react/react-original-wordmark.svg">
  <img align="center" alt="NextJS" width="65" height="35" src="https://github.com/devicons/devicon/blob/master/icons/nextjs/nextjs-original-wordmark.svg">
  <img align="center" alt="Next Auth" width="35" height="35" src="https://next-auth.js.org/img/logo/logo-xs.png">
  <img align="center" alt="Supabase" width="65" height="35" src="https://github.com/devicons/devicon/blob/master/icons/supabase/supabase-original-wordmark.svg">
  <img align="center" alt="Zustand" width="35" height="35" src="https://github.com/pmndrs/zustand/raw/main/docs/favicon.ico">
  <img align="center" alt="Swiper" width="35" height="35" src="https://github.com/devicons/devicon/blob/master/icons/swiper/swiper-original.svg">
  <img align="center" alt="Tailwind" width="65" height="35" src="https://github.com/devicons/devicon/blob/master/icons/tailwindcss/tailwindcss-original-wordmark.svg">
</div>

<br>
<br>
<br>

## O que √© a Care+? - Hist√≥ria üìú  
A Care+ √© uma empresa brasileira que se dedica a oferecer produtos e servi√ßos para a sa√∫de √≠ntima feminina, oferece uma ampla variedade de produtos, incluindo absorventes, protetores di√°rios, len√ßos umedecidos e √≥leos √≠ntimos. Todos os produtos s√£o desenvolvidos com ingredientes naturais e seguros, e s√£o testados dermatologicamente para garantir a m√°xima seguran√ßa e conforto.

A Care+ √© uma empresa comprometida com a sustentabilidade e a responsabilidade social, a empresa utiliza embalagens recicl√°veis e biodegrad√°veis, e tamb√©m apoia diversas causas sociais.

A empresa oferece produtos de alta qualidade, seguros e confort√°veis!

### Miss√£o üéØ
Oferecer produtos de alta qualidade que proporcionem conforto, seguran√ßa e bem-estar durante o per√≠odo menstrual, promovendo a sa√∫de √≠ntima feminina e a autoestima de nossas consumidoras.

### Vis√£o üëÅ‚Äçüó®
Ser a marca l√≠der em produtos para higiene feminina, reconhecida pela inova√ß√£o, qualidade e compromisso com o bem-estar da mulher, contribuindo para um mundo mais consciente e igualit√°rio.

### Valores üéñ
Nossos valores s√£o: Cuidado, Inova√ß√£o, Qualidade, Sustentabilidade e Empoderamento Feminino.

<br>

### ‚ö†Ô∏è AVISO ‚ö†Ô∏è
A Care+ √© apenas uma empresa fict√≠cia, sendo assim n√£o √© uma empresa real, com isso toda sua constru√ß√£o de branding e postura como marca **N√ÉO** existem!

<br>

## UI/UX üé®
Constru√≠ a aplica√ß√£o buscando trazer uma sensa√ß√£o de leveza e conforto para os usu√°rios com foco no p√∫blico alvo feminino, para isso apliquei alguns dos conceitos relacionados a design e tipografia que aprendi com os cursos que realizei ao longo da minha trajet√≥ria na programa√ß√£o, e mais recentemente reforcei durante minha leitura do livro ["Design pra quem n√£o √© designer"](https://www.linkedin.com/posts/victor-lis-bronzo_ol%C3%A1-rede-hoje-vim-compartilhar-uma-experi%C3%AAncia-activity-7274045545764044800-CeAs?utm_source=share&utm_medium=member_desktop).

### Cores
| Cor               | Hexadecimal                                                |
| ----------------- | ---------------------------------------------------------------- |
| Primary |  ![#F3EFE0](https://via.placeholder.com/10/f3efe0?text=+) #f3efe0 |
| Primary Strong |  ![#EEE8D3](https://via.placeholder.com/10/EEE8D3?text=+) #EEE8D3 |
| Secondary |  ![#F6A2B4](https://via.placeholder.com/10/F6A2B4?text=+) #F6A2B4 |
| Secondary Strong |  ![#EE5879](https://via.placeholder.com/10/EE5879?text=+) #EE5879 |
| Tertiary |  ![#D9E4FC](https://via.placeholder.com/10/D9E4FC?text=+) #D9E4FC |
| Tertiary Strong |  ![#517FF6](https://via.placeholder.com/10/517FF6?text=+) #517FF6 |

### Fontes
| Fonte               | Link                                                |
| ----------------- | ---------------------------------------------------------------- |
| Dosis        | [Google Fonts](https://fonts.google.com/specimen/Dosis?query=dosis) |
| Sour Gummy       | [Google Fonts](https://fonts.google.com/specimen/Sour+Gummy?query=Sour+Gummy) |

<br>
<br>  

## Database - Supabase 
Para facilitar o entendimento do projeto deixo aqui o Schema do Banco de Dados construido atrav√©s do Supabase, para facilitar o entendimento do Supabase compartilho tamb√©m a [documenta√ß√£o dele](https://supabase.com/) e um [PDF](https://github.com/user-attachments/files/18278009/Supabase.pdf) sobre de autoria pr√≥pria.

### Schema
![Schema](https://github.com/user-attachments/assets/3ab3469f-47d5-48bd-b42f-d15eca86b474)

<br>
<br>

## Resumo das P√°ginas

### Home - /home üè†
Rota inicial da aplica√ß√£o, cumpre os principais requisitos da vaga, contendo vagamente a banner, produtos, hist√≥ria da empresa, formul√°rio de contato...

https://github.com/user-attachments/assets/a8a7cbab-7f33-4754-bc0c-7bcd3b4e0e01

<br>

#### Contato üìß
Sua principal funcionalidade √© no formul√°rio de contato, atrav√©s da biblioteca "EmailJS" √© enviado um email para o endere√ßo victorlisbronzo1@gmail.com, meu email, com as informa√ß√µes da pessoa e sua mensagem.

A constru√ß√£o desse foi bem simples, a "grande" dificuldade foi realizar as devidas configura√ß√µes no [site do EmailJS](https://dashboard.emailjs.com/sign-in), depois disso bastou criar a fun√ß√£o abaixo.

<br>

#### Configura√ß√µes
<div className="width: 100%; display: flex; justify-content: center; align-items: center;">
  <img alt="Configura√ß√µes 1" src="https://github.com/user-attachments/assets/c88c3c46-5c29-443f-8805-f327a1066e73">
  <img alt="Configura√ß√µes 2" src="https://github.com/user-attachments/assets/4294353a-7316-4830-a848-e51ccb74d5e4">
</div>

<br>

#### C√≥digo
```ts
  // Importa√ß√£o:
  import emailjs from "@emailjs/browser";

  // O principal requisito √© usar um useRef para referenciar o forms
  // No caso tamb√©m utilizei 3 useStates para verificar se os campos foram preenchidos, mas n√£o √© uma necessidade
  function sendEmail(e: React.FormEvent<HTMLFormElement>) {
    e.preventDefault();

    if (!form.current) {
      console.error("Form element not found");
      return;
    }

    if (!name || !email || !message) {
      alert("Preencha os campos para entrar em contato!")
      return
    }

    const formData = new FormData(form.current);
    const formValues: Record<string, string> = {};

    formData.forEach((value, key) => {
      formValues[key] = value as string;
    });

    // Basta adicionar minha chave da API configurada no site
    emailjs
      .sendForm(process.env.NEXT_PUBLIC_SERVICE_ID as string, process.env.NEXT_PUBLIC_TEMPLATE_ID as string, form.current, {
        publicKey: process.env.NEXT_PUBLIC_PUBLIC_KEY as string,
        ...formValues,
      })
      .then(() => {
        alert("Contato realizado!")
        form?.current?.reset();
        clearForm()
      })
      .catch((error) => {
        alert("Erro ao realizar contato, tente novamente...")
        form?.current?.reset();
        clearForm()
        console.error(error)
      });
  }
```
Com isso as informa√ß√µes do forms, tamb√©m configuradas no site, conseguem ser lidas e ent√£o enviadas ao meu email!

<br>
<br>

### Produtos - /produtos üõç
A tela produtos tem como sua principal fun√ß√£o tornar f√°cil para o usu√°rio encontrar todos os produtos em um √∫nico lugar, incluindo inclusive um mecanismo de pesquisa e de filtro, para tornar mais √°gil o processo de encontrar o produto desejado

https://github.com/user-attachments/assets/08022bc8-206b-4ff8-98cd-847f80fcd2fa

<br>

#### Filtro e Pesquisa üîç
O c√≥digo a ser destacado aqui nessa tela pode ser dividido em 2 que se destacam, com o primeiro sendo o mecanismo de pesquisa, que com o Zustand possibilita uma pesquisa r√°pida, sem delay e agrad√°vel para o usu√°rio.

Com o uso do Zustand os componentes tem suas fun√ß√µes mais "nichadas", deixando o c√≥digo mais limpo, seria com utilizar um Context ou o Redux, mas com mais desempenho, sendo assim √© poss√≠vel conectar v√°rios componentes sem o "Apocalipse de Props"

<br>

##### FilterStore - Zustand üêª
```ts
import type { CategoryType } from '@/@types/category'
import { create } from 'zustand'

type FilterStore = {
  categories: CategoryType[]
  addCategory: (category: CategoryType) => void
  removeCategory: (category: CategoryType) => void
  inputText: string,
  updateInputText: (text: string) => void,
}

export const useFilterStore = create<FilterStore>((set) => ({
  categories: [],
  addCategory: (category: CategoryType) => set((state) => ({
    categories: [ ...state.categories, category ]
  })),
  removeCategory: (category: CategoryType) => set((state) => ({
    categories: state.categories.filter((cat) => cat.id !== category.id)
  })),
  inputText: "",
  updateInputText: (text: string) => set(() => ({inputText: text}))
}))
```

<br>

##### Input de Pesquisa
```ts
export default function InputFilter() {
  const { updateInputText, inputText } = useFilterStore();

  return (
    <input
      className="bg-white px-2 py-1 min-[850px]:px-4 min-[850px]:py-2 rounded-sm outline-none border-2 border-white flex-[4]"
      placeholder="Produto"
      name="product"
      onChange={(e) => updateInputText(e.target.value)}
      value={inputText}
    />
  );
}
```

<br>

##### CheckBox Component
```ts
export default function CategoryCheckbox({ category }:{ category: CategoryType }) {
  const { categories, addCategory, removeCategory } = useFilterStore()

  const [checked, setChecked] = useState<boolean>(false)

  const toggleChecked = () => { 
    setChecked(!checked)
  }

  function handleChange(){
    if(checked){
      addCategory(category)
    } else {
      removeCategory(category)
    }
  }

  useEffect(() => {
    function isAlreadyChecked(){
      categories.find((cat) => cat.id === category.id) ? setChecked(true) : ''
    }
    isAlreadyChecked()
  }, [])

  useEffect(() => { handleChange() }, [checked])

  return (
    <div className="flex justify-start items-center" key={category.name}>
      <button
        type="button"
        className="p-0.5 mr-1 cursor-pointer flex justify-center items-center"
        onClick={toggleChecked}
      >
        {checked ? <LuCheck size={20} color="#517FF6"/> : <MdOutlineCheckBoxOutlineBlank size={20} color="#517FF6"/>}
      </button>
      <h2 className="text-tertiary-strong">{category.name}</h2>
    </div>
  );
}
```

<br>

Ap√≥s os componentes anteriores definirem os filtros no store do Zustand, basta mapear os items que se adequam aos filtros
```ts
export default function ProductsGrid() {
  const { products, getProducts } = useProductsStore();
  const { categories, inputText } = useFilterStore();

  useEffect(() => {
    !products.length ? getProducts() : "";
  }, []);

  const filteredProducts = products.filter((product) => {
    return (
      (!categories.length || !!categories.find((category) => category.id === product.categoria)) &&
      (!inputText.length || product.name.toLowerCase().includes(inputText.toLowerCase()))
    )
  });

  return (
    <div className="w-full px-16 max-[850px]:px-8 max-sm:px-2 py-4 min-[850px]:py-2.5 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 justify-start content-start items-start gap-4">
      {filteredProducts.map((produto) => {
        return <Product key={produto.id} {...produto} />;
      })}
    </div>
  );
}
```

<br>
<br>

### Produto - /produto/[...id] üì¶
Essa tela visualmente falando √© uma das mais simples, por√©m por de tr√°s de seu devido funcionamento utilizei um recurso muito interessante interligando o funcionamento base do NextJS, com o React Router por debaixo dos panos do framework, e o uso do Zustand, para garantir que a experi√™ncia do usu√°rio seja fluida e prazerosa!

https://github.com/user-attachments/assets/781f6f7f-0e8b-4f31-a13b-14ba3ef09513

<br>

#### Zustand && [...id] 
Afinal, qual foi a estrat√©gia utilizada para obter um tempo de resposta ainda mais r√°pido a adapt√°vel para o usu√°rio? 

Com o **Zustand** √© poss√≠vel **acessar rapidamente dados armazenados** durante a execu√ß√£o da aplica√ß√£o, ou seja, se o usu√°rio j√° estiver no site e clicar em um produto, aquele produto j√° est√° pre-carregado e com isso se torna quase instant√¢neo o processo de constru√ß√£o da tela daquele produto puxando seus valores. 

Entretando, em **qualquer site/e-commerce que se preze** tem a possibilidade de **compartilhar um produto entre os usu√°rios**, e nossa aplica√ß√£o n√£o poderia ser diferente! 

Afinal, supondo que uma usu√°ria esteja pensando em comprar um produto, mas ainda n√£o tem certeza se vai finalizar a compra e decide **salvar o link**, ou ainda se ela simplesmente quiser **compartilhar com algu√©m**, o que iria acontecer usando apenas o Zustand? A aplica√ß√£o n√£o conseguira saber qual foi o produto escolhido, afinal n√£o teria o "id" (Par√¢metro da URL), a √∫nica forma de acessar o produto seria atrav√©s da navega√ß√£o do usu√°rio pela aplica√ß√£o e ent√£o clique nesse. 

Por√©m pegar o produto usando apenas o **"id" via par√¢metro da URL seria um desperd√≠cio**, pois o **Zustand j√° est√° com os dados disponiveis** para uso (sem nem precisar carregar esses em um modelo SSR para otimizar).

Qual foi a solu√ß√£o ent√£o? **Implementar os 2 recursos**

Mas como? A aplica√ß√£o de maneira inteligente consegue discernir entre qual forma puxar dados utilizar, caso o produto em cache no Zustand seja nulo(null), significa que o usu√°rio entrou via link diretamente naquela tela e n√£o h√° dados em cache, portanto, a tela precisar√° puxar os dados diretamente da database, se o produto em cache estiver presente, basta utilizar!

Segue o c√≥digo desse trecho
```ts
export default function Produto() {
  const { product, setProduct } = useProductStore();
  const params = useParams<ProdutoParams>()

  async function handleGetProduct() {
    if (!product) {
      const { id } = await params;
      if (!id) redirect("/");

      const { product } = await getProduct({ id });
      if (!product) redirect("/");
      setProduct(product);
    }
  }

  useEffect(() => {
    handleGetProduct();
  }, []);

  if (product) {
    return (
      <div className="min-h-svh w-full bg-primary px-24 max-md:px-10 pt-16">
        <Main produto={product} />
        <Products category_id={product.categoria} product_id={product.id} />
        <Footer type="primary-strong" />
      </div>
    );
  }

  return <Loader/>
}
```

<br>
<br>

### Carrinho - /carrinho üõí
Na tela carrinho o principal destaque vai para a fun√ß√£o em SQL 'get_user_cart', criada para conseguir correlacionar as informa√ß√µes das tabelas "produto" e "carrinho" na database, antes de implentar essa fun√ß√£o a manipula√ß√£o de dados era realizada no front-end, com a fun√ß√£o respons√°vel por isso tendo mais de 100 linhas (desde puxar os dados e ent√£o adaptar) al√©m de uma queda de desempenho bem impactante, por√©m utilizando o incr√≠vel comando SQL "WITH()" foi poss√≠vel deixar toda essa manipula√ß√£o de dados em SQL e, portanto, tendo mais desempenho, deixo ela abaixo e seu uso:

#### Fun√ß√£o 'get_user_cart()' - Supabase
```SQL

WITH CarrinhoUsuario AS (
  SELECT 
    c.id,
    c.amount,
    c.final_price,
    c.product_id,
    c.user_email
  FROM public.carrinho AS c
  WHERE c.user_email = email_param
),
FormattedCart AS (
  SELECT
    c.id,
    c.amount,
    c.final_price,
    c.product_id,
    c.user_email,
    json_build_object(
      'id', p.id,
      'created_at', p.created_at,
      'name', p.name,
      'price', p.price,
      'description', p.description,
      'image_id', p.image_id,
      'image_url', p.image_url,
      'categoria', p.categoria
    ) AS produto
  FROM CarrinhoUsuario c
  INNER JOIN public.produto p ON c.product_id = p.id
)
SELECT json_agg(f.*)::JSONB
FROM FormattedCart f;
```

<br>

#### Criando fun√ß√£o que conecta ao Supabase - src/lib/supabase/getCartUserProduts.ts
```ts
import { supabase } from "./supabase";

export async function getUserCartProducts({ email }: { email: string }) {
  const { data, error } = await supabase.rpc("get_user_cart", {
    email_param: email,
  });
  if (error) console.error(error);
  return !!data ? data : []
}
``` 

<br>

#### Chamando fun√ß√£o que armazena os dados no Storage do Zustand - src/lib/zustand/productsInCart.ts
```ts
import { create } from "zustand";

import type { FormattedCartItemType } from "@/@types/formattedCart";
import type { ProductType } from "@/@types/product";
import type { CartItemType } from "@/@types/cartItemType";
import { getUserCartProducts } from "../supabase/getUserCartProducts";

type FormattedProductsStore = {
  formattedProducts: FormattedCartItemType[];
  getFormattedProducts: (email: string) => Promise<boolean>;
};

export const useFormattedProductsStore = create<FormattedProductsStore>(
  (set) => ({
    formattedProducts: [],
    getFormattedProducts: async (email) => {
      const formattedProducts = await getUserCartProducts({email});
      set(() => ({ formattedProducts }));
      return true;
    },
  })
);
``` 
Com isso de maneira f√°cil consigo os dados formatados e prontos para serem utilizados! 

<br>
<br>

### Perfil - /perfil üë•
A rota realiza um reajuste de acordo com a sess√£o do user, se o usu√°rio n√£o estiver logado a p√°gina exibe um componente que pede o login dele, se estiver logado s√£o exibidos seus dados. Mesmo n√£o sendo uma funcionalidade exclusiva dessa rota, √© destac√°vel o uso do [Next-Auth](https://next-auth.js.org/) para permitir uma integra√ß√£o segura, robusta e f√°cil com os mais diversos modelos de OAuth 2.0, o escolhido para o caso foi o mais comum e presente no dia a dia das pessoas hoje em dia, o Google OAuth.

<br>

#### /perfil/page.tsx
```ts
"use client"

import Loader from "@/components/global/Loader";
import NoSignIn from "@/components/perfil/NoSignIn";
import WithSignIn from "@/components/perfil/WithSignIn";
import { useSession } from "next-auth/react";

export default function perfil() {
  const { data: session, status } = useSession();

 return (
  <div>
    {status === "loading" ? <Loader/> : session?.user?.email ? <WithSignIn/> : <NoSignIn/>}
  </div>
 );
}
```

<br>

#### WithSignIn - src/components/perfil/WithSignIn.tsx
![WithSignIn](https://github.com/user-attachments/assets/f180ae4b-0cef-4310-baeb-86b158196348)

<br>

#### NoSignIn - src/components/perfil/NoSignIn.tsx
![NoSignIn](https://github.com/user-attachments/assets/8d52746d-042b-41e4-9107-75972ede6f99)

<br>
<br>

## Instala√ß√£o üì≤
Para instalar a aplica√ß√£o em ambiente de desenvolvimento basta seguir o passo a passo abaixo:
<br>

**1- Com as depend√™ncias do git j√° presentes**
```cmd
  git clone https://github.com/Victor-Lis/CarePlus 
```
<br>

**2- Com as depend√™ncias do npm j√° presentes**
```cmd
  cd CarePlus & npm i
```
<br>

**3- Colar o arquivo .env na raiz do projeto e preencher o .env com suas credenciais**
```dir
  CarePlus/.env
```
```.env
# EMAILJS
NEXT_PUBLIC_SERVICE_ID=
NEXT_PUBLIC_TEMPLATE_ID=
NEXT_PUBLIC_PUBLIC_KEY=

# NextAuth
SECRET=
NEXTAUTH_SECRET=
NEXT_AUTH_URL=
NEXT_PUBLIC_HOST_URL=
NEXT_AUTH_SECRET=

# Supabase
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=

# Google
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
```
<br>

**4- Agora basta rodar!**
```cmd
npm run dev
```
<br>

<br>

# Autores üßë‚Äçüíº
- [@Victor-Lis](https://www.linkedin.com/in/victor-lis-bronzo)
